local a,b,c,d=(function(e)local f={[{}]=true}local g;local h={}local require;local i={}g=function(j,k)if not h[j]then h[j]=k end end;require=function(j)local l=i[j]if l then if l==f then return nil end else if not h[j]then if not e then local m=type(j)=='string'and'\"'..j..'\"'or tostring(j)error('Tried to require '..m..', but no such module has been registered')else return e(j)end end;i[j]=f;l=h[j](require,i,g,h)i[j]=l end;return l end;return require,i,g,h end)(require)c("__root",function(require,n,c,d)function plugindef()finaleplugin.Author="Robert Patterson"finaleplugin.Copyright="CC0 https://creativecommons.org/publicdomain/zero/1.0/"finaleplugin.Version="1.0.1"finaleplugin.Date="June 12, 2020"finaleplugin.CategoryTags="Staff"return"Reset Full Group Name Fonts","Reset Full Group Name Fonts","Reset all full group names to document's default font settings."end;local o=require("library.general_library")local p=require("library.enigma_string")function prefs_reset_group_full_name_fonts()local q=o.get_selected_region_or_whole_doc()local r=finale.FCFontInfo()r:LoadFontPrefs(finale.FONTPREF_GROUPNAME)local s=finale.FCGroups()s:LoadAll()for t in each(s)do if o.group_overlaps_region(t,q)then if t:HasFullName()then text_block=finale.FCTextBlock()if text_block:Load(t:GetFullNameID())then if p.change_first_text_block_font(text_block,r)then text_block:Save()end end end end end end;prefs_reset_group_full_name_fonts()end)c("library.enigma_string",function(require,n,c,d)local o={}function o.finale_version(u,v,w)local x=bit32.bor(bit32.lshift(math.floor(u),24),bit32.lshift(math.floor(v),20))if w then x=bit32.bor(x,math.floor(w))end;return x end;function o.group_overlaps_region(y,z)if z:IsFullDocumentSpan()then return true end;local A=false;local B=finale.FCSystemStaves()B:LoadAllForRegion(z)for C in each(B)do if y:ContainsStaff(C:GetStaff())then A=true;break end end;if not A then return false end;if y.StartMeasure>z.EndMeasure or y.EndMeasure<z.StartMeasure then return false end;return true end;function o.group_is_contained_in_region(y,z)if not z:IsStaffIncluded(y.StartStaff)then return false end;if not z:IsStaffIncluded(y.EndStaff)then return false end;return true end;function o.staff_group_is_multistaff_instrument(y)local D=finale.FCMultiStaffInstruments()D:LoadAll()for E in each(D)do if E:ContainsStaff(y.StartStaff)and E.GroupID==y:GetItemID()then return true end end;return false end;function o.get_selected_region_or_whole_doc()local q=finenv.Region()if q:IsEmpty()then q:SetFullDocument()end;return q end;function o.get_first_cell_on_or_after_page(F)local G=F;local H=finale.FCPage()local I=false;while H:Load(G)do if H:GetFirstSystem()>0 then I=true;break end;G=G+1 end;if I then local J=finale.FCStaffSystem()J:Load(H:GetFirstSystem())return finale.FCCell(J.FirstMeasure,J.TopStaff)end;local K=finale.FCMusicRegion()K:SetFullDocument()return finale.FCCell(K.EndMeasure,K.EndStaff)end;function o.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local L=finale.FCMusicRegion()L:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),L.StartStaff)end;return o.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function o.get_top_left_selected_or_visible_cell()local q=finenv.Region()if not q:IsEmpty()then return finale.FCCell(q.StartMeasure,q.StartStaff)end;return o.get_top_left_visible_cell()end;function o.is_default_measure_number_visible_on_cell(M,N,O,P)local Q=finale.FCCurrentStaffSpec()if not Q:LoadForCell(N,0)then return false end;if M:GetShowOnTopStaff()and N.Staff==O.TopStaff then return true end;if M:GetShowOnBottomStaff()and N.Staff==O:CalcBottomStaff()then return true end;if Q.ShowMeasureNumbers then return not M:GetExcludeOtherStaves(P)end;return false end;function o.is_default_number_visible_and_left_aligned(M,N,R,P,S)if M.UseScoreInfoForParts then P=false end;if S and M:GetShowOnMultiMeasureRests(P)then if finale.MNALIGN_LEFT~=M:GetMultiMeasureAlignment(P)then return false end elseif N.Measure==R.FirstMeasure then if not M:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=M:GetStartAlignment(P)then return false end else if not M:GetShowMultiples(P)then return false end;if finale.MNALIGN_LEFT~=M:GetMultipleAlignment(P)then return false end end;return o.is_default_measure_number_visible_on_cell(M,N,R,P)end;function o.update_layout(T,U)T=T or 1;U=U or false;local V=finale.FCPage()if V:Load(T)then V:UpdateLayout(U)end end;function o.get_current_part()local W=finale.FCParts()W:LoadAll()return W:GetCurrent()end;function o.get_page_format_prefs()local X=o.get_current_part()local Y=finale.FCPageFormatPrefs()local Z=false;if X:IsScore()then Z=Y:LoadScore()else Z=Y:LoadParts()end;return Y,Z end;function o.get_smufl_metadata_file(r)if not r then r=finale.FCFontInfo()r:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local _=function(a0,r)local a1=a0 .."/SMuFL/Fonts/"..r.Name.."/"..r.Name..".json"return io.open(a1,"r")end;local a2=""if finenv.UI():IsOnWindows()then a2=os.getenv("LOCALAPPDATA")else a2=os.getenv("HOME").."/Library/Application Support"end;local a3=_(a2,r)if nil~=a3 then return a3 end;local a4="/Library/Application Support"if finenv.UI():IsOnWindows()then a4=os.getenv("COMMONPROGRAMFILES")end;return _(a4,r)end;function o.is_font_smufl_font(r)if not r then r=finale.FCFontInfo()r:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=o.finale_version(27,1)then if nil~=r.IsSMuFLFont then return r.IsSMuFLFont end end;local a5=o.get_smufl_metadata_file(r)if nil~=a5 then io.close(a5)return true end;return false end;function o.simple_input(a6,a7)local a8=finale.FCString()a8.LuaString=""local a9=finale.FCString()local aa=160;function format_ctrl(ab,ac,ad,ae)ab:SetHeight(ac)ab:SetWidth(ad)a9.LuaString=ae;ab:SetText(a9)end;title_width=string.len(a6)*6+54;if title_width>aa then aa=title_width end;text_width=string.len(a7)*6;if text_width>aa then aa=text_width end;a9.LuaString=a6;local af=finale.FCCustomLuaWindow()af:SetTitle(a9)local ag=af:CreateStatic(0,0)format_ctrl(ag,16,aa,a7)local ah=af:CreateEdit(0,20)format_ctrl(ah,20,aa,"")af:CreateOkButton()af:CreateCancelButton()function callback(ab)end;af:RegisterHandleCommand(callback)if af:ExecuteModal(nil)==finale.EXECMODAL_OK then a8.LuaString=ah:GetText(a8)return a8.LuaString end end;function o.is_finale_object(ai)return ai and type(ai)=="userdata"and ai.ClassName and ai.GetClassID and true or false end;function o.system_indent_set_to_prefs(R,Y)Y=Y or o.get_page_format_prefs()local aj=finale.FCMeasure()local ak=R.FirstMeasure==1;if not ak and aj:Load(R.FirstMeasure)then if aj.ShowFullNames then ak=true end end;if ak and Y.UseFirstSystemMargins then R.LeftMargin=Y.FirstSystemLeft else R.LeftMargin=Y.SystemLeft end;return R:Save()end;return o end)c("library.general_library",function(require,n,c,d)local o={}function o.finale_version(u,v,w)local x=bit32.bor(bit32.lshift(math.floor(u),24),bit32.lshift(math.floor(v),20))if w then x=bit32.bor(x,math.floor(w))end;return x end;function o.group_overlaps_region(y,z)if z:IsFullDocumentSpan()then return true end;local A=false;local B=finale.FCSystemStaves()B:LoadAllForRegion(z)for C in each(B)do if y:ContainsStaff(C:GetStaff())then A=true;break end end;if not A then return false end;if y.StartMeasure>z.EndMeasure or y.EndMeasure<z.StartMeasure then return false end;return true end;function o.group_is_contained_in_region(y,z)if not z:IsStaffIncluded(y.StartStaff)then return false end;if not z:IsStaffIncluded(y.EndStaff)then return false end;return true end;function o.staff_group_is_multistaff_instrument(y)local D=finale.FCMultiStaffInstruments()D:LoadAll()for E in each(D)do if E:ContainsStaff(y.StartStaff)and E.GroupID==y:GetItemID()then return true end end;return false end;function o.get_selected_region_or_whole_doc()local q=finenv.Region()if q:IsEmpty()then q:SetFullDocument()end;return q end;function o.get_first_cell_on_or_after_page(F)local G=F;local H=finale.FCPage()local I=false;while H:Load(G)do if H:GetFirstSystem()>0 then I=true;break end;G=G+1 end;if I then local J=finale.FCStaffSystem()J:Load(H:GetFirstSystem())return finale.FCCell(J.FirstMeasure,J.TopStaff)end;local K=finale.FCMusicRegion()K:SetFullDocument()return finale.FCCell(K.EndMeasure,K.EndStaff)end;function o.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local L=finale.FCMusicRegion()L:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),L.StartStaff)end;return o.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function o.get_top_left_selected_or_visible_cell()local q=finenv.Region()if not q:IsEmpty()then return finale.FCCell(q.StartMeasure,q.StartStaff)end;return o.get_top_left_visible_cell()end;function o.is_default_measure_number_visible_on_cell(M,N,O,P)local Q=finale.FCCurrentStaffSpec()if not Q:LoadForCell(N,0)then return false end;if M:GetShowOnTopStaff()and N.Staff==O.TopStaff then return true end;if M:GetShowOnBottomStaff()and N.Staff==O:CalcBottomStaff()then return true end;if Q.ShowMeasureNumbers then return not M:GetExcludeOtherStaves(P)end;return false end;function o.is_default_number_visible_and_left_aligned(M,N,R,P,S)if M.UseScoreInfoForParts then P=false end;if S and M:GetShowOnMultiMeasureRests(P)then if finale.MNALIGN_LEFT~=M:GetMultiMeasureAlignment(P)then return false end elseif N.Measure==R.FirstMeasure then if not M:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=M:GetStartAlignment(P)then return false end else if not M:GetShowMultiples(P)then return false end;if finale.MNALIGN_LEFT~=M:GetMultipleAlignment(P)then return false end end;return o.is_default_measure_number_visible_on_cell(M,N,R,P)end;function o.update_layout(T,U)T=T or 1;U=U or false;local V=finale.FCPage()if V:Load(T)then V:UpdateLayout(U)end end;function o.get_current_part()local W=finale.FCParts()W:LoadAll()return W:GetCurrent()end;function o.get_page_format_prefs()local X=o.get_current_part()local Y=finale.FCPageFormatPrefs()local Z=false;if X:IsScore()then Z=Y:LoadScore()else Z=Y:LoadParts()end;return Y,Z end;function o.get_smufl_metadata_file(r)if not r then r=finale.FCFontInfo()r:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local _=function(a0,r)local a1=a0 .."/SMuFL/Fonts/"..r.Name.."/"..r.Name..".json"return io.open(a1,"r")end;local a2=""if finenv.UI():IsOnWindows()then a2=os.getenv("LOCALAPPDATA")else a2=os.getenv("HOME").."/Library/Application Support"end;local a3=_(a2,r)if nil~=a3 then return a3 end;local a4="/Library/Application Support"if finenv.UI():IsOnWindows()then a4=os.getenv("COMMONPROGRAMFILES")end;return _(a4,r)end;function o.is_font_smufl_font(r)if not r then r=finale.FCFontInfo()r:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=o.finale_version(27,1)then if nil~=r.IsSMuFLFont then return r.IsSMuFLFont end end;local a5=o.get_smufl_metadata_file(r)if nil~=a5 then io.close(a5)return true end;return false end;function o.simple_input(a6,a7)local a8=finale.FCString()a8.LuaString=""local a9=finale.FCString()local aa=160;function format_ctrl(ab,ac,ad,ae)ab:SetHeight(ac)ab:SetWidth(ad)a9.LuaString=ae;ab:SetText(a9)end;title_width=string.len(a6)*6+54;if title_width>aa then aa=title_width end;text_width=string.len(a7)*6;if text_width>aa then aa=text_width end;a9.LuaString=a6;local af=finale.FCCustomLuaWindow()af:SetTitle(a9)local ag=af:CreateStatic(0,0)format_ctrl(ag,16,aa,a7)local ah=af:CreateEdit(0,20)format_ctrl(ah,20,aa,"")af:CreateOkButton()af:CreateCancelButton()function callback(ab)end;af:RegisterHandleCommand(callback)if af:ExecuteModal(nil)==finale.EXECMODAL_OK then a8.LuaString=ah:GetText(a8)return a8.LuaString end end;function o.is_finale_object(ai)return ai and type(ai)=="userdata"and ai.ClassName and ai.GetClassID and true or false end;function o.system_indent_set_to_prefs(R,Y)Y=Y or o.get_page_format_prefs()local aj=finale.FCMeasure()local ak=R.FirstMeasure==1;if not ak and aj:Load(R.FirstMeasure)then if aj.ShowFullNames then ak=true end end;if ak and Y.UseFirstSystemMargins then R.LeftMargin=Y.FirstSystemLeft else R.LeftMargin=Y.SystemLeft end;return R:Save()end;return o end)return a("__root")