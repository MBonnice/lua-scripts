local a,b,c,d=(function(e)local f={[{}]=true}local g;local h={}local require;local i={}g=function(j,k)if not h[j]then h[j]=k end end;require=function(j)local l=i[j]if l then if l==f then return nil end else if not h[j]then if not e then local m=type(j)=='string'and'\"'..j..'\"'or tostring(j)error('Tried to require '..m..', but no such module has been registered')else return e(j)end end;i[j]=f;l=h[j](require,i,g,h)i[j]=l end;return l end;return require,i,g,h end)(require)c("__root",function(require,n,c,d)function plugindef()finaleplugin.RequireSelection=true;finaleplugin.Author="Robert Patterson"finaleplugin.Copyright="CC0 https://creativecommons.org/publicdomain/zero/1.0/"finaleplugin.Version="1.0"finaleplugin.Date="March 8, 2021"finaleplugin.CategoryTags="Note"return"Delete Duplicate Noteheads","Delete Duplicate Noteheads","Removes duplicate noteheads from chords and adjusts ties as needed."end;local o=require("library.note_entry")function notehead_delete_duplicates()for p in eachentrysaved(finenv.Region())do local q={}for r in each(p)do local s=bit32.bor(r.RaiseLower,bit32.lshift(r.Displacement,16))if nil==q[s]then q[s]=r else if r.Tie then q[s].Tie=true end;if r.TieBackwards then q[s].TieBackwards=true end;if r.AccidentalFreeze then q[s].AccidentalFreeze=true;q[s].Accidental=r.AccidentalFreeze;if r.AccidentalParentheses then q[s].AccidentalParentheses=true end end;o.delete_note(r)end end end end;notehead_delete_duplicates()end)c("library.note_entry",function(require,n,c,d)local t={}function t.finale_version(u,v,w)local x=bit32.bor(bit32.lshift(math.floor(u),24),bit32.lshift(math.floor(v),20))if w then x=bit32.bor(x,math.floor(w))end;return x end;function t.group_overlaps_region(y,z)if z:IsFullDocumentSpan()then return true end;local A=false;local B=finale.FCSystemStaves()B:LoadAllForRegion(z)for C in each(B)do if y:ContainsStaff(C:GetStaff())then A=true;break end end;if not A then return false end;if y.StartMeasure>z.EndMeasure or y.EndMeasure<z.StartMeasure then return false end;return true end;function t.group_is_contained_in_region(y,z)if not z:IsStaffIncluded(y.StartStaff)then return false end;if not z:IsStaffIncluded(y.EndStaff)then return false end;return true end;function t.staff_group_is_multistaff_instrument(y)local D=finale.FCMultiStaffInstruments()D:LoadAll()for E in each(D)do if E:ContainsStaff(y.StartStaff)and E.GroupID==y:GetItemID()then return true end end;return false end;function t.get_selected_region_or_whole_doc()local F=finenv.Region()if F:IsEmpty()then F:SetFullDocument()end;return F end;function t.get_first_cell_on_or_after_page(G)local H=G;local I=finale.FCPage()local J=false;while I:Load(H)do if I:GetFirstSystem()>0 then J=true;break end;H=H+1 end;if J then local K=finale.FCStaffSystem()K:Load(I:GetFirstSystem())return finale.FCCell(K.FirstMeasure,K.TopStaff)end;local L=finale.FCMusicRegion()L:SetFullDocument()return finale.FCCell(L.EndMeasure,L.EndStaff)end;function t.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local M=finale.FCMusicRegion()M:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),M.StartStaff)end;return t.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function t.get_top_left_selected_or_visible_cell()local F=finenv.Region()if not F:IsEmpty()then return finale.FCCell(F.StartMeasure,F.StartStaff)end;return t.get_top_left_visible_cell()end;function t.is_default_measure_number_visible_on_cell(N,O,P,Q)local R=finale.FCCurrentStaffSpec()if not R:LoadForCell(O,0)then return false end;if N:GetShowOnTopStaff()and O.Staff==P.TopStaff then return true end;if N:GetShowOnBottomStaff()and O.Staff==P:CalcBottomStaff()then return true end;if R.ShowMeasureNumbers then return not N:GetExcludeOtherStaves(Q)end;return false end;function t.is_default_number_visible_and_left_aligned(N,O,S,Q,T)if N.UseScoreInfoForParts then Q=false end;if T and N:GetShowOnMultiMeasureRests(Q)then if finale.MNALIGN_LEFT~=N:GetMultiMeasureAlignment(Q)then return false end elseif O.Measure==S.FirstMeasure then if not N:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=N:GetStartAlignment(Q)then return false end else if not N:GetShowMultiples(Q)then return false end;if finale.MNALIGN_LEFT~=N:GetMultipleAlignment(Q)then return false end end;return t.is_default_measure_number_visible_on_cell(N,O,S,Q)end;function t.update_layout(U,V)U=U or 1;V=V or false;local W=finale.FCPage()if W:Load(U)then W:UpdateLayout(V)end end;function t.get_current_part()local X=finale.FCParts()X:LoadAll()return X:GetCurrent()end;function t.get_page_format_prefs()local Y=t.get_current_part()local Z=finale.FCPageFormatPrefs()local _=false;if Y:IsScore()then _=Z:LoadScore()else _=Z:LoadParts()end;return Z,_ end;function t.get_smufl_metadata_file(a0)if not a0 then a0=finale.FCFontInfo()a0:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local a1=function(a2,a0)local a3=a2 .."/SMuFL/Fonts/"..a0.Name.."/"..a0.Name..".json"return io.open(a3,"r")end;local a4=""if finenv.UI():IsOnWindows()then a4=os.getenv("LOCALAPPDATA")else a4=os.getenv("HOME").."/Library/Application Support"end;local a5=a1(a4,a0)if nil~=a5 then return a5 end;local a6="/Library/Application Support"if finenv.UI():IsOnWindows()then a6=os.getenv("COMMONPROGRAMFILES")end;return a1(a6,a0)end;function t.is_font_smufl_font(a0)if not a0 then a0=finale.FCFontInfo()a0:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=t.finale_version(27,1)then if nil~=a0.IsSMuFLFont then return a0.IsSMuFLFont end end;local a7=t.get_smufl_metadata_file(a0)if nil~=a7 then io.close(a7)return true end;return false end;function t.simple_input(a8,a9)local aa=finale.FCString()aa.LuaString=""local ab=finale.FCString()local ac=160;function format_ctrl(ad,ae,af,ag)ad:SetHeight(ae)ad:SetWidth(af)ab.LuaString=ag;ad:SetText(ab)end;title_width=string.len(a8)*6+54;if title_width>ac then ac=title_width end;text_width=string.len(a9)*6;if text_width>ac then ac=text_width end;ab.LuaString=a8;local ah=finale.FCCustomLuaWindow()ah:SetTitle(ab)local ai=ah:CreateStatic(0,0)format_ctrl(ai,16,ac,a9)local aj=ah:CreateEdit(0,20)format_ctrl(aj,20,ac,"")ah:CreateOkButton()ah:CreateCancelButton()function callback(ad)end;ah:RegisterHandleCommand(callback)if ah:ExecuteModal(nil)==finale.EXECMODAL_OK then aa.LuaString=aj:GetText(aa)return aa.LuaString end end;function t.is_finale_object(ak)return ak and type(ak)=="userdata"and ak.ClassName and ak.GetClassID and true or false end;function t.system_indent_set_to_prefs(S,Z)Z=Z or t.get_page_format_prefs()local al=finale.FCMeasure()local am=S.FirstMeasure==1;if not am and al:Load(S.FirstMeasure)then if al.ShowFullNames then am=true end end;if am and Z.UseFirstSystemMargins then S.LeftMargin=Z.FirstSystemLeft else S.LeftMargin=Z.SystemLeft end;return S:Save()end;return t end)return a("__root")