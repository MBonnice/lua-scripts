local a,b,c,d=(function(e)local f={[{}]=true}local g;local h={}local require;local i={}g=function(j,k)if not h[j]then h[j]=k end end;require=function(j)local l=i[j]if l then if l==f then return nil end else if not h[j]then if not e then local m=type(j)=='string'and'\"'..j..'\"'or tostring(j)error('Tried to require '..m..', but no such module has been registered')else return e(j)end end;i[j]=f;l=h[j](require,i,g,h)i[j]=l end;return l end;return require,i,g,h end)(require)c("__root",function(require,n,c,d)function plugindef()finaleplugin.Author="Nick Mazuk"finaleplugin.Copyright="CC0 https://creativecommons.org/publicdomain/zero/1.0/"finaleplugin.Version="1.0.0"finaleplugin.Date="March 26, 2022"finaleplugin.CategoryTags="Playback"finaleplugin.AuthorURL="https://nickmazuk.com"finaleplugin.Notes=[[
        Swaps layers 1 and 2 for the selected region.
    ]]return"Swap layers 1 and 2","Swap layers 1 and 2","Swaps layers 1 and 2"end;local o=require("library.layer")function layers_swap_1_2()o.swap(finenv.Region(),1,2)end;layers_swap_1_2()end)c("library.layer",function(require,n,c,d)local p={}function p.finale_version(q,r,s)local t=bit32.bor(bit32.lshift(math.floor(q),24),bit32.lshift(math.floor(r),20))if s then t=bit32.bor(t,math.floor(s))end;return t end;function p.group_overlaps_region(u,v)if v:IsFullDocumentSpan()then return true end;local w=false;local x=finale.FCSystemStaves()x:LoadAllForRegion(v)for y in each(x)do if u:ContainsStaff(y:GetStaff())then w=true;break end end;if not w then return false end;if u.StartMeasure>v.EndMeasure or u.EndMeasure<v.StartMeasure then return false end;return true end;function p.group_is_contained_in_region(u,v)if not v:IsStaffIncluded(u.StartStaff)then return false end;if not v:IsStaffIncluded(u.EndStaff)then return false end;return true end;function p.staff_group_is_multistaff_instrument(u)local z=finale.FCMultiStaffInstruments()z:LoadAll()for A in each(z)do if A:ContainsStaff(u.StartStaff)and A.GroupID==u:GetItemID()then return true end end;return false end;function p.get_selected_region_or_whole_doc()local B=finenv.Region()if B:IsEmpty()then B:SetFullDocument()end;return B end;function p.get_first_cell_on_or_after_page(C)local D=C;local E=finale.FCPage()local F=false;while E:Load(D)do if E:GetFirstSystem()>0 then F=true;break end;D=D+1 end;if F then local G=finale.FCStaffSystem()G:Load(E:GetFirstSystem())return finale.FCCell(G.FirstMeasure,G.TopStaff)end;local H=finale.FCMusicRegion()H:SetFullDocument()return finale.FCCell(H.EndMeasure,H.EndStaff)end;function p.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local I=finale.FCMusicRegion()I:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),I.StartStaff)end;return p.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function p.get_top_left_selected_or_visible_cell()local B=finenv.Region()if not B:IsEmpty()then return finale.FCCell(B.StartMeasure,B.StartStaff)end;return p.get_top_left_visible_cell()end;function p.is_default_measure_number_visible_on_cell(J,K,L,M)local N=finale.FCCurrentStaffSpec()if not N:LoadForCell(K,0)then return false end;if J:GetShowOnTopStaff()and K.Staff==L.TopStaff then return true end;if J:GetShowOnBottomStaff()and K.Staff==L:CalcBottomStaff()then return true end;if N.ShowMeasureNumbers then return not J:GetExcludeOtherStaves(M)end;return false end;function p.is_default_number_visible_and_left_aligned(J,K,O,M,P)if J.UseScoreInfoForParts then M=false end;if P and J:GetShowOnMultiMeasureRests(M)then if finale.MNALIGN_LEFT~=J:GetMultiMeasureAlignment(M)then return false end elseif K.Measure==O.FirstMeasure then if not J:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=J:GetStartAlignment(M)then return false end else if not J:GetShowMultiples(M)then return false end;if finale.MNALIGN_LEFT~=J:GetMultipleAlignment(M)then return false end end;return p.is_default_measure_number_visible_on_cell(J,K,O,M)end;function p.update_layout(Q,R)Q=Q or 1;R=R or false;local S=finale.FCPage()if S:Load(Q)then S:UpdateLayout(R)end end;function p.get_current_part()local T=finale.FCParts()T:LoadAll()return T:GetCurrent()end;function p.get_page_format_prefs()local U=p.get_current_part()local V=finale.FCPageFormatPrefs()local W=false;if U:IsScore()then W=V:LoadScore()else W=V:LoadParts()end;return V,W end;function p.get_smufl_metadata_file(X)if not X then X=finale.FCFontInfo()X:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local Y=function(Z,X)local _=Z.."/SMuFL/Fonts/"..X.Name.."/"..X.Name..".json"return io.open(_,"r")end;local a0=""if finenv.UI():IsOnWindows()then a0=os.getenv("LOCALAPPDATA")else a0=os.getenv("HOME").."/Library/Application Support"end;local a1=Y(a0,X)if nil~=a1 then return a1 end;local a2="/Library/Application Support"if finenv.UI():IsOnWindows()then a2=os.getenv("COMMONPROGRAMFILES")end;return Y(a2,X)end;function p.is_font_smufl_font(X)if not X then X=finale.FCFontInfo()X:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=p.finale_version(27,1)then if nil~=X.IsSMuFLFont then return X.IsSMuFLFont end end;local a3=p.get_smufl_metadata_file(X)if nil~=a3 then io.close(a3)return true end;return false end;function p.simple_input(a4,a5)local a6=finale.FCString()a6.LuaString=""local a7=finale.FCString()local a8=160;function format_ctrl(a9,aa,ab,ac)a9:SetHeight(aa)a9:SetWidth(ab)a7.LuaString=ac;a9:SetText(a7)end;title_width=string.len(a4)*6+54;if title_width>a8 then a8=title_width end;text_width=string.len(a5)*6;if text_width>a8 then a8=text_width end;a7.LuaString=a4;local ad=finale.FCCustomLuaWindow()ad:SetTitle(a7)local ae=ad:CreateStatic(0,0)format_ctrl(ae,16,a8,a5)local af=ad:CreateEdit(0,20)format_ctrl(af,20,a8,"")ad:CreateOkButton()ad:CreateCancelButton()function callback(a9)end;ad:RegisterHandleCommand(callback)if ad:ExecuteModal(nil)==finale.EXECMODAL_OK then a6.LuaString=af:GetText(a6)return a6.LuaString end end;function p.is_finale_object(ag)return ag and type(ag)=="userdata"and ag.ClassName and ag.GetClassID and true or false end;function p.system_indent_set_to_prefs(O,V)V=V or p.get_page_format_prefs()local ah=finale.FCMeasure()local ai=O.FirstMeasure==1;if not ai and ah:Load(O.FirstMeasure)then if ah.ShowFullNames then ai=true end end;if ai and V.UseFirstSystemMargins then O.LeftMargin=V.FirstSystemLeft else O.LeftMargin=V.SystemLeft end;return O:Save()end;return p end)return a("__root")