local a,b,c,d=(function(e)local f={[{}]=true}local g;local h={}local require;local i={}g=function(j,k)if not h[j]then h[j]=k end end;require=function(j)local l=i[j]if l then if l==f then return nil end else if not h[j]then if not e then local m=type(j)=='string'and'\"'..j..'\"'or tostring(j)error('Tried to require '..m..', but no such module has been registered')else return e(j)end end;i[j]=f;l=h[j](require,i,g,h)i[j]=l end;return l end;return require,i,g,h end)(require)c("__root",function(require,n,c,d)function plugindef()finaleplugin.RequireSelection=true;finaleplugin.Author="Michael McClennan"finaleplugin.Version="1.0"finaleplugin.Date="August 14, 2021"finaleplugin.AuthorURL="www.michaelmcclennan.com"finaleplugin.AuthorEmail="info@michaelmcclennan.com"finaleplugin.CategoryTags="Chord"return"Chord Accidental - Move Up","Adjust Chord Accidental Up","Adjust the accidental of chord symbol up"end;local o=require("library.configuration")local p={vertical_increment=5}o.get_parameters("chord_accidental_adjust.config.txt",p)function chord_accidental_adjust_up()local q=finale.FCChordPrefs()q:Load(1)local r=q:GetFlatBaselineAdjustment()local s=q:GetSharpBaselineAdjustment()local t=q:GetNaturalBaselineAdjustment()local q=finale.FCChordPrefs()q:Load(1)q:GetFlatBaselineAdjustment()q.FlatBaselineAdjustment=p.vertical_increment+r;q:GetSharpBaselineAdjustment()q.SharpBaselineAdjustment=p.vertical_increment+s;q:GetNaturalBaselineAdjustment()q.NaturalBaselineAdjustment=p.vertical_increment+t;q:Save()end;chord_accidental_adjust_up()end)c("library.configuration",function(require,n,c,d)local u={}function u.finale_version(v,w,x)local y=bit32.bor(bit32.lshift(math.floor(v),24),bit32.lshift(math.floor(w),20))if x then y=bit32.bor(y,math.floor(x))end;return y end;function u.group_overlaps_region(z,A)if A:IsFullDocumentSpan()then return true end;local B=false;local C=finale.FCSystemStaves()C:LoadAllForRegion(A)for D in each(C)do if z:ContainsStaff(D:GetStaff())then B=true;break end end;if not B then return false end;if z.StartMeasure>A.EndMeasure or z.EndMeasure<A.StartMeasure then return false end;return true end;function u.group_is_contained_in_region(z,A)if not A:IsStaffIncluded(z.StartStaff)then return false end;if not A:IsStaffIncluded(z.EndStaff)then return false end;return true end;function u.staff_group_is_multistaff_instrument(z)local E=finale.FCMultiStaffInstruments()E:LoadAll()for F in each(E)do if F:ContainsStaff(z.StartStaff)and F.GroupID==z:GetItemID()then return true end end;return false end;function u.get_selected_region_or_whole_doc()local G=finenv.Region()if G:IsEmpty()then G:SetFullDocument()end;return G end;function u.get_first_cell_on_or_after_page(H)local I=H;local J=finale.FCPage()local K=false;while J:Load(I)do if J:GetFirstSystem()>0 then K=true;break end;I=I+1 end;if K then local L=finale.FCStaffSystem()L:Load(J:GetFirstSystem())return finale.FCCell(L.FirstMeasure,L.TopStaff)end;local M=finale.FCMusicRegion()M:SetFullDocument()return finale.FCCell(M.EndMeasure,M.EndStaff)end;function u.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local N=finale.FCMusicRegion()N:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),N.StartStaff)end;return u.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function u.get_top_left_selected_or_visible_cell()local G=finenv.Region()if not G:IsEmpty()then return finale.FCCell(G.StartMeasure,G.StartStaff)end;return u.get_top_left_visible_cell()end;function u.is_default_measure_number_visible_on_cell(O,P,Q,R)local S=finale.FCCurrentStaffSpec()if not S:LoadForCell(P,0)then return false end;if O:GetShowOnTopStaff()and P.Staff==Q.TopStaff then return true end;if O:GetShowOnBottomStaff()and P.Staff==Q:CalcBottomStaff()then return true end;if S.ShowMeasureNumbers then return not O:GetExcludeOtherStaves(R)end;return false end;function u.is_default_number_visible_and_left_aligned(O,P,T,R,U)if O.UseScoreInfoForParts then R=false end;if U and O:GetShowOnMultiMeasureRests(R)then if finale.MNALIGN_LEFT~=O:GetMultiMeasureAlignment(R)then return false end elseif P.Measure==T.FirstMeasure then if not O:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=O:GetStartAlignment(R)then return false end else if not O:GetShowMultiples(R)then return false end;if finale.MNALIGN_LEFT~=O:GetMultipleAlignment(R)then return false end end;return u.is_default_measure_number_visible_on_cell(O,P,T,R)end;function u.update_layout(V,W)V=V or 1;W=W or false;local X=finale.FCPage()if X:Load(V)then X:UpdateLayout(W)end end;function u.get_current_part()local Y=finale.FCParts()Y:LoadAll()return Y:GetCurrent()end;function u.get_page_format_prefs()local Z=u.get_current_part()local _=finale.FCPageFormatPrefs()local a0=false;if Z:IsScore()then a0=_:LoadScore()else a0=_:LoadParts()end;return _,a0 end;function u.get_smufl_metadata_file(a1)if not a1 then a1=finale.FCFontInfo()a1:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local a2=function(a3,a1)local a4=a3 .."/SMuFL/Fonts/"..a1.Name.."/"..a1.Name..".json"return io.open(a4,"r")end;local a5=""if finenv.UI():IsOnWindows()then a5=os.getenv("LOCALAPPDATA")else a5=os.getenv("HOME").."/Library/Application Support"end;local a6=a2(a5,a1)if nil~=a6 then return a6 end;local a7="/Library/Application Support"if finenv.UI():IsOnWindows()then a7=os.getenv("COMMONPROGRAMFILES")end;return a2(a7,a1)end;function u.is_font_smufl_font(a1)if not a1 then a1=finale.FCFontInfo()a1:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=u.finale_version(27,1)then if nil~=a1.IsSMuFLFont then return a1.IsSMuFLFont end end;local a8=u.get_smufl_metadata_file(a1)if nil~=a8 then io.close(a8)return true end;return false end;function u.simple_input(a9,aa)local ab=finale.FCString()ab.LuaString=""local ac=finale.FCString()local ad=160;function format_ctrl(ae,af,ag,ah)ae:SetHeight(af)ae:SetWidth(ag)ac.LuaString=ah;ae:SetText(ac)end;title_width=string.len(a9)*6+54;if title_width>ad then ad=title_width end;text_width=string.len(aa)*6;if text_width>ad then ad=text_width end;ac.LuaString=a9;local ai=finale.FCCustomLuaWindow()ai:SetTitle(ac)local aj=ai:CreateStatic(0,0)format_ctrl(aj,16,ad,aa)local ak=ai:CreateEdit(0,20)format_ctrl(ak,20,ad,"")ai:CreateOkButton()ai:CreateCancelButton()function callback(ae)end;ai:RegisterHandleCommand(callback)if ai:ExecuteModal(nil)==finale.EXECMODAL_OK then ab.LuaString=ak:GetText(ab)return ab.LuaString end end;function u.is_finale_object(al)return al and type(al)=="userdata"and al.ClassName and al.GetClassID and true or false end;function u.system_indent_set_to_prefs(T,_)_=_ or u.get_page_format_prefs()local am=finale.FCMeasure()local an=T.FirstMeasure==1;if not an and am:Load(T.FirstMeasure)then if am.ShowFullNames then an=true end end;if an and _.UseFirstSystemMargins then T.LeftMargin=_.FirstSystemLeft else T.LeftMargin=_.SystemLeft end;return T:Save()end;return u end)return a("__root")