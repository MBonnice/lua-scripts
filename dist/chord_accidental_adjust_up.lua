local a,b,c,d=(function(e)local f={[{}]=true}local g;local h={}local require;local i={}g=function(j,k)if not h[j]then h[j]=k end end;require=function(j)local l=i[j]if l then if l==f then return nil end else if not h[j]then if not e then local m=type(j)=='string'and'\"'..j..'\"'or tostring(j)error('Tried to require '..m..', but no such module has been registered')else return e(j)end end;i[j]=f;l=h[j](require,i,g,h)i[j]=l end;return l end;return require,i,g,h end)(require)c("__root",function(require,n,c,d)function plugindef()finaleplugin.RequireSelection=true;finaleplugin.Author="Michael McClennan"finaleplugin.Version="1.0"finaleplugin.Date="August 14, 2021"finaleplugin.AuthorURL="www.michaelmcclennan.com"finaleplugin.AuthorEmail="info@michaelmcclennan.com"finaleplugin.CategoryTags="Chord"return"Chord Accidental - Move Up","Adjust Chord Accidental Up","Adjust the accidental of chord symbol up"end;local o=require("library.configuration")local p={vertical_increment=5}o.get_parameters("chord_accidental_adjust.config.txt",p)function chord_accidental_adjust_up()local q=finale.FCChordPrefs()q:Load(1)local r=q:GetFlatBaselineAdjustment()local s=q:GetSharpBaselineAdjustment()local t=q:GetNaturalBaselineAdjustment()local q=finale.FCChordPrefs()q:Load(1)q:GetFlatBaselineAdjustment()q.FlatBaselineAdjustment=p.vertical_increment+r;q:GetSharpBaselineAdjustment()q.SharpBaselineAdjustment=p.vertical_increment+s;q:GetNaturalBaselineAdjustment()q.NaturalBaselineAdjustment=p.vertical_increment+t;q:Save()end;chord_accidental_adjust_up()end)c("library.configuration",function(require,n,c,d)local u={}function u.finale_version(v,w,x)local y=bit32.bor(bit32.lshift(math.floor(v),24),bit32.lshift(math.floor(w),20))if x then y=bit32.bor(y,math.floor(x))end;return y end;function u.group_overlaps_region(z,A)if A:IsFullDocumentSpan()then return true end;local B=false;local C=finale.FCSystemStaves()C:LoadAllForRegion(A)for D in each(C)do if z:ContainsStaff(D:GetStaff())then B=true;break end end;if not B then return false end;if z.StartMeasure>A.EndMeasure or z.EndMeasure<A.StartMeasure then return false end;return true end;function u.group_is_contained_in_region(z,A)if not A:IsStaffIncluded(z.StartStaff)then return false end;if not A:IsStaffIncluded(z.EndStaff)then return false end;return true end;function u.staff_group_is_multistaff_instrument(z)local E=finale.FCMultiStaffInstruments()E:LoadAll()for F in each(E)do if F:ContainsStaff(z.StartStaff)and F.GroupID==z:GetItemID()then return true end end;return false end;function u.get_selected_region_or_whole_doc()local G=finenv.Region()if G:IsEmpty()then G:SetFullDocument()end;return G end;function u.get_first_cell_on_or_after_page(H)local I=H;local J=finale.FCPage()local K=false;while J:Load(I)do if J:GetFirstSystem()>0 then K=true;break end;I=I+1 end;if K then local L=finale.FCStaffSystem()L:Load(J:GetFirstSystem())return finale.FCCell(L.FirstMeasure,L.TopStaff)end;local M=finale.FCMusicRegion()M:SetFullDocument()return finale.FCCell(M.EndMeasure,M.EndStaff)end;function u.get_top_left_visible_cell()if not finenv.UI():IsPageView()then local N=finale.FCMusicRegion()N:SetFullDocument()return finale.FCCell(finenv.UI():GetCurrentMeasure(),N.StartStaff)end;return u.get_first_cell_on_or_after_page(finenv.UI():GetCurrentPage())end;function u.get_top_left_selected_or_visible_cell()local G=finenv.Region()if not G:IsEmpty()then return finale.FCCell(G.StartMeasure,G.StartStaff)end;return u.get_top_left_visible_cell()end;function u.is_default_measure_number_visible_on_cell(O,P,Q,R)local S=finale.FCCurrentStaffSpec()if not S:LoadForCell(P,0)then return false end;if O:GetShowOnTopStaff()and P.Staff==Q.TopStaff then return true end;if O:GetShowOnBottomStaff()and P.Staff==Q:CalcBottomStaff()then return true end;if S.ShowMeasureNumbers then return not O:GetExcludeOtherStaves(R)end;return false end;function u.is_default_number_visible_and_left_aligned(O,P,T,R,U)if O.UseScoreInfoForParts then R=false end;if U and O:GetShowOnMultiMeasureRests(R)then if finale.MNALIGN_LEFT~=O:GetMultiMeasureAlignment(R)then return false end elseif P.Measure==T.FirstMeasure then if not O:GetShowOnSystemStart()then return false end;if finale.MNALIGN_LEFT~=O:GetStartAlignment(R)then return false end else if not O:GetShowMultiples(R)then return false end;if finale.MNALIGN_LEFT~=O:GetMultipleAlignment(R)then return false end end;return u.is_default_measure_number_visible_on_cell(O,P,T,R)end;function u.update_layout(V,W)V=V or 1;W=W or false;local X=finale.FCPage()if X:Load(V)then X:UpdateLayout(W)end end;function u.get_current_part()local Y=finale.FCParts()Y:LoadAll()return Y:GetCurrent()end;function u.get_page_format_prefs()local Z=u.get_current_part()local _=finale.FCPageFormatPrefs()local a0=false;if Z:IsScore()then a0=_:LoadScore()else a0=_:LoadParts()end;return _,a0 end;local a1=function(a2)local a3=finenv.UI():IsOnWindows()local a4=function(a5,a6)if finenv.UI():IsOnWindows()then return a5 and os.getenv(a5)or""else return a6 and os.getenv(a6)or""end end;local a7=a2 and a4("LOCALAPPDATA","HOME")or a4("COMMONPROGRAMFILES")if not a3 then a7=a7 .."/Library/Application Support"end;a7=a7 .."/SMuFL/Fonts/"return a7 end;function u.get_smufl_font_list()local a8={}local a9=function(a2)local a7=a1(a2)local aa=function()if finenv.UI():IsOnWindows()then return io.popen('dir "'..a7 ..'" /b /ad')else return io.popen('ls "'..a7 ..'"')end end;local ab=function(ac)local ad=finale.FCString()ad.LuaString=ac;return finenv.UI():IsFontAvailable(ad)end;for ac in aa():lines()do if not ac:find("%.")then ac=ac:gsub(" Bold","")ac=ac:gsub(" Italic","")local ad=finale.FCString()ad.LuaString=ac;if a8[ac]or ab(ac)then a8[ac]=a2 and"user"or"system"end end end end;a9(true)a9(false)return a8 end;function u.get_smufl_metadata_file(ae)if not ae then ae=finale.FCFontInfo()ae:LoadFontPrefs(finale.FONTPREF_MUSIC)end;local af=function(ag,ae)local ah=ag..ae.Name.."/"..ae.Name..".json"return io.open(ah,"r")end;local ai=af(a1(true),ae)if ai then return ai end;return af(a1(false),ae)end;function u.is_font_smufl_font(ae)if not ae then ae=finale.FCFontInfo()ae:LoadFontPrefs(finale.FONTPREF_MUSIC)end;if finenv.RawFinaleVersion>=u.finale_version(27,1)then if nil~=ae.IsSMuFLFont then return ae.IsSMuFLFont end end;local aj=u.get_smufl_metadata_file(ae)if nil~=aj then io.close(aj)return true end;return false end;function u.simple_input(ak,al)local am=finale.FCString()am.LuaString=""local an=finale.FCString()local ao=160;function format_ctrl(ap,aq,ar,as)ap:SetHeight(aq)ap:SetWidth(ar)an.LuaString=as;ap:SetText(an)end;title_width=string.len(ak)*6+54;if title_width>ao then ao=title_width end;text_width=string.len(al)*6;if text_width>ao then ao=text_width end;an.LuaString=ak;local at=finale.FCCustomLuaWindow()at:SetTitle(an)local au=at:CreateStatic(0,0)format_ctrl(au,16,ao,al)local av=at:CreateEdit(0,20)format_ctrl(av,20,ao,"")at:CreateOkButton()at:CreateCancelButton()function callback(ap)end;at:RegisterHandleCommand(callback)if at:ExecuteModal(nil)==finale.EXECMODAL_OK then am.LuaString=av:GetText(am)return am.LuaString end end;function u.is_finale_object(aw)return aw and type(aw)=="userdata"and aw.ClassName and aw.GetClassID and true or false end;function u.system_indent_set_to_prefs(T,_)_=_ or u.get_page_format_prefs()local ax=finale.FCMeasure()local ay=T.FirstMeasure==1;if not ay and ax:Load(T.FirstMeasure)then if ax.ShowFullNames then ay=true end end;if ay and _.UseFirstSystemMargins then T.LeftMargin=_.FirstSystemLeft else T.LeftMargin=_.SystemLeft end;return T:Save()end;function u.calc_script_name(az)local aA=finale.FCString()if finenv.RunningLuaFilePath then aA.LuaString=finenv.RunningLuaFilePath()else aA:SetRunningLuaFilePath()end;local aB=finale.FCString()aA:SplitToPathAndFile(nil,aB)local y=aB.LuaString;if not az then y=y:match("(.+)%..+")if not y or y==""then y=aB.LuaString end end;return y end;return u end)return a("__root")