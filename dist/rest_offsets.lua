function plugindef()finaleplugin.RequireSelection=true;finaleplugin.Copyright="CC0 https://creativecommons.org/publicdomain/zero/1.0/"finaleplugin.AuthorURL="http://carlvine.com/lua/"finaleplugin.Version="v1.3"finaleplugin.Date="2022/06/19"finaleplugin.Notes=[[
    Several situations including cross-staff notation (rests should be centred between the staves) 
    require adjusting the vertical position (offset) of rests. 
    This script duplicates the action of Finale's inbuilt "Move rests..." plug-in but needs no mouse activity. 
    It is also an easy way to reset rest offsets to zero in every layer, the default setting. 
    (Offest zero centres on the middle staff line.)
]]return"Rest offsets","Rest offsets","Rest vertical offsets"end;function show_error(a,b)local c={bad_offset="Rest offset must be an integer\nbetween, say, 60 and -60\n(not ",bad_layer_number="Layer number must be an\ninteger between zero and 4\n(not "}finenv.UI():AlertNeutral("script: "..plugindef(),c[a]..b..")")end;function get_user_choices()local d=110;local e=finenv.UI():IsOnMac()and 3 or 0;local f={}local g=finale.FCCustomWindow()local h=finale.FCString()h.LuaString=plugindef()g:SetTitle(h)local i={{"Vertical offset:",rest_offset or 0,15},{"Layer 1-4 (0 = all):",layer_number or 0,50}}for j,k in ipairs(i)do h.LuaString=k[1]local l=g:CreateStatic(0,k[3])l:SetText(h)l:SetWidth(d)f[j]=g:CreateEdit(d,k[3]-e)f[j]:SetInteger(k[2])f[j]:SetWidth(50)end;i={{"4",5,"= top staff line",0},{"0",5,"= middle staff line",15},{"-4",0,"= bottom staff line",30}}for j,k in ipairs(i)do h.LuaString=k[1]g:CreateStatic(d+60+k[2],k[4]):SetText(h)local l=g:CreateStatic(d+75,k[4])h.LuaString=k[3]l:SetText(h)l:SetWidth(d)end;g:CreateOkButton()g:CreateCancelButton()return g:ExecuteModal(nil)==finale.EXECMODAL_OK,f[1]:GetInteger(),f[2]:GetInteger()end;function change_rest_offset()local m=6;local n=false;n,rest_offset,layer_number=get_user_choices()if not n then return end;if rest_offset<-60 or rest_offset>60 then show_error("bad_offset",rest_offset)return end;if layer_number<0 or layer_number>4 then show_error("bad_layer_number",layer_number)return end;if finenv.RetainLuaState~=nil then finenv.RetainLuaState=true end;for o in eachentrysaved(finenv.Region(),layer_number)do if o:IsRest()then o:SetRestDisplacement(rest_offset+m)end end end;change_rest_offset()