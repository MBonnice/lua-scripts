function plugindef()finaleplugin.RequireSelection=false;finaleplugin.Author="Jari Williamsson"finaleplugin.Copyright="CC0 https://creativecommons.org/publicdomain/zero/1.0/"finaleplugin.Version="1.0.1"finaleplugin.RevisionNotes=[[
        Edited by Nick Mazuk to give more detailed duration statistics
        ]]finaleplugin.Date="June 26, 2020"finaleplugin.CategoryTags="Note"return"Note Duration Statistics","Note Duration Statistics","Counts the number of each note value in a given region"end;local a=0;local b={}for c in eachentry(finenv.Region())do if c:IsNote()then if b[c.Duration]==nil then b[c.Duration]=1 else b[c.Duration]=b[c.Duration]+1 end;a=a+1 end end;local d={[finale.NOTE_128TH]="128th Notes",[finale.SIXTYFOURTH_NOTE]="64th Notes",[finale.THIRTYSECOND_NOTE]="32th Notes",[finale.SIXTEENTH_NOTE]="16th Notes",[finale.EIGHTH_NOTE]="8th Notes",[finale.QUARTER_NOTE]="Quarter Notes",[finale.HALF_NOTE]="Half Notes",[finale.WHOLE_NOTE]="Whole Notes",[finale.BREVE]="Breve",[48]="Dotted 128th Notes",[96]="Dotted 64th Notes",[192]="Dotted 32nd Notes",[640]="Dotted 16th Notes",[760]="Dotted 8th Notes",[1536]="Dotted Quarter Notes",[3072]="Dotted Half Notes",[6144]="Dotted Whole Notes",[12288]="Dotted Breve Notes"}userMessage=finale.FCString()print("Total Count : ",a)userMessage:AppendLuaString("Total Count : "..a..userMessage:GetEOL())for e,f in pairsbykeys(b)do if d[e]==nil then print("EDU duration",e,":",f)userMessage:AppendLuaString("EDU duration "..e.." : "..f..userMessage:GetEOL())else print(d[e],":",f)userMessage:AppendLuaString(d[e].." : "..f..userMessage:GetEOL())end end;local g=finenv.UI()g:AlertInfo(userMessage.LuaString,"Note Durations Statistics")