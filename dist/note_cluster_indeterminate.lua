function plugindef()finaleplugin.RequireSelection=true;finaleplugin.Author="Jacob Winkler"finaleplugin.Copyright="Â©2019 Jacob Winkler"finaleplugin.AuthorEmail="jacob.winkler@mac.com"finaleplugin.Version="1.0"finaleplugin.Date="11/02/2019"return"Cluster - Indeterminate","Cluster - Indeterminate","Creates Indeterminate Clusters"end;local a=finale.FCDistancePrefs()a:Load(1)local b=finale.FCSizePrefs()b:Load(1)local c=b.StemLineThickness;c=c/64;function cluster_indeterminate()for d in eachentrysaved(finenv.Region())do if d:IsNote()and d.Count>1 then local e=d.Count;local f=1;local g=finale.FCDotMod()local h=d:CalcLowestNote(nil)local i=h:CalcStaffPosition()local j=i%2;local k=0;local l=false;local m=1;for n in each(d)do local o=d:CalcStemUp()local p=n:CalcRightsidePlacement()if o==true and p==true then l=true end;if m==2 then k=n:CalcStaffPosition()-i end;m=m+1 end;for n in each(d)do local o=d:CalcStemUp()local q=finale.FCNoteheadMod()q:EraseAt(n)q:SetUseCustomFont(true)q.FontName="Engraver Font Set"local r=35;local s=n:CalcRightsidePlacement()if d.Duration<2048 then q.CustomChar=242;if o==true and s==true then q.HorizontalPos=-r end;if o==false and s==false then q.HorizontalPos=r end end;if d.Duration>=2048 and d.Duration<4096 then if f==1 then q.CustomChar=201 elseif f==e then q.CustomChar=59 else q.CustomChar=58 end;if o==true and s==true then q.HorizontalPos=-r end;if o==false and s==false then q.HorizontalPos=r end end;if d.Duration>=4096 then if f==1 then q.CustomChar=201 elseif f==e then q.CustomChar=59 else q.CustomChar=58 end;r=32;if o==true and s==true then q.HorizontalPos=-r end;if o==false and s==false then q.HorizontalPos=r end end;if f>1 and f<e then n.Tie=false end;if d:IsDotted()then local t=0;if l==true then t=-r end;if f==1 and k<=1 and j==1 then g.VerticalPos=24 elseif f>1 and f<e then g.VerticalPos=10000;g.HorizontalPos=10000 else g.VerticalPos=0 end;g.HorizontalPos=t;g:SaveAt(n)end;n.AccidentalFreeze=true;n.Accidental=false;q:SaveAt(n)f=f+1 end;d.LedgerLines=false end end end;cluster_indeterminate()